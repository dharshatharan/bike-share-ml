version: 2

models:
  - name: fct_trips_daily_v2
    description: Simplified daily bike share trip facts - v2 minimal feature set for ML
    columns:
      # Primary key
      - name: trip_date
        data_type: date
        tests:
          - not_null
          - unique

      # Date & Time features (non-leaky)
      - name: day_of_week
        data_type: bigint
        tests:
          - not_null
      - name: day_name
        data_type: varchar
        tests:
          - not_null
      - name: is_weekend
        data_type: boolean
        tests:
          - not_null
      - name: is_holiday
        data_type: boolean
        tests:
          - not_null
      - name: has_covid_restrictions
        data_type: boolean
        tests:
          - not_null
      - name: month_num
        data_type: bigint
        tests:
          - not_null
      - name: year
        data_type: bigint
        tests:
          - not_null
      - name: day_of_month
        data_type: bigint
        tests:
          - not_null
      - name: week_of_year
        data_type: bigint
        tests:
          - not_null

      # Target variables (LEAKY - what we're predicting)
      - name: total_trips__leaky
        data_type: bigint
        tests:
          - not_null
      - name: avg_trip_duration__leaky
        data_type: double
        tests:
          - not_null

      # Weather features (non-leaky)
      - name: mean_temp_c
        data_type: double
        tests:
          - not_null
      - name: total_precip_mm
        data_type: double
        tests:
          - not_null

      # Trip volume features (non-leaky - predictive)
      - name: trips_lag_7d
        data_type: bigint
      - name: trips_rolling_7d_avg
        data_type: double

      # User mix features (non-leaky - predictive)
      - name: annual_member_ratio_lag_7d
        data_type: double
